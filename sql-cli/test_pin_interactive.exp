#!/usr/bin/expect -f
set timeout 5

# Start the application with debug logging
spawn env RUST_LOG=sql_cli::data::data_view=debug,sql_cli::ui::viewport_manager=debug ./target/release/sql-cli test_pin_columns.csv -e "select * from data"

# Wait for TUI to load
sleep 0.5

# Navigate to the second column (name)
send "l"
sleep 0.2

# Pin the current column
send "p"
sleep 0.5

# Navigate right a few columns
send "lll"
sleep 0.2

# Try to scroll right to see if pinned column stays
send "\[C\[C\[C"
sleep 0.5

# Clear all pins
send "P"
sleep 0.5

# Exit
send "q"
expect eof